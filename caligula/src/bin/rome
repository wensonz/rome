#!/usr/bin/env node

/**
 * This module contains the implementation of the HTTP API server for project
 * ROME.
 * 
 * @module rome
 */
var caligula = require('caligula'),
    config = null;

config = {
    "dotti": {
        "router": {
            "params": {
                "0": { "value": {
                    "": "handlers.service"
                }}
            }
        },
        "handlers.service": {
            "type": "caligula.handlers.ServiceHandler",
            "params": {
                "0": { "value": caligula.defaults.http }
            }
        }
    }
};

caligula.bootstrap(config, function (error, C) {
    var factory = null,
        app = null;
    
    if (error) {
        process.stderr.write(error.toString());
        process.exit(error.code || 1);
    }
    
    factory = new C.di.DottiFactory(config.dotti);
    app = factory.get('app');
    app.run();
});